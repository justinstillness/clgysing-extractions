================================================================================
EXTRACTION: 2026-02-11_060026_notebook-query
================================================================================
Source Package:  N/A
Pass Type:       N/A (N/A)
Pass Number:     N/A
Theme/Focus:     Untagged
Routing:         Tier 3 (Untagged)
Query:           What is the current Majeston architecture? How is it installed, what port does it run on, and what are the key maintenance procedures including the token refresh process and jacob-bd update command?
Timestamp:       2026-02-11T06:00:26.000045+00:00
Notebook ID:     430df618-e337-4971-abaa-6528e96bb1c4
Source IDs:      all
Conversation ID: 94ed5fe4-e515-4e89-b70d-21a525f1f4b5
Chat Configure:  default
Response Chars:  2451
Duration:        21000ms
================================================================================

Based on the provided architecture references, here is the current status of the Majeston component.

### **Majeston Architecture**
Majeston is the foundational **NotebookLM MCP** tool (package: `jacob-bd/notebooklm-mcp-cli`) that bridges Claude to Google's NotebookLM service [1].

*   **Pipeline Integration:** In the current architecture (v4.0), Majeston does **not** handle traffic directly from Caddy. It runs behind the **SeraphRecorder** traffic capture pipeline.
*   **The Wrapper:** The systemd service (`notebooklm-mcp`) executes a process manager called `mcp-wrapper.py` instead of the Majeston binary directly. This wrapper launches a `socat` proxy to capture traffic for analysis before forwarding it to Majeston [2, 3].

### **Installation & Ports**
Majeston is installed natively on the EC2 instance using `uv` (a Python tool manager), having fully replaced the initial Docker deployment [4, 5].

*   **Internal Port (Actual):** **8100**. This is where the Majeston binary listens [6].
*   **Pipeline Port (Exposed):** **8000**. `socat` listens here, captures traffic, and forwards it to port 8100. Caddy routes external traffic to this port [6, 7].
*   **External Port:** **443**. Accessible securely via Caddy at `https://mcp.justinstillness.com/mcp` [8].

### **Key Maintenance Procedures**

#### **1. Token Refresh Process (Every 10...14 Days)**
Because the EC2 instance is headless (no browser), you cannot authenticate directly on the server. You must refresh tokens on your Mac and push them to the server [9].

1.  **On Mac Terminal:** Run `nlm login`.
    *   *This opens Chrome for Google OAuth and saves tokens locally.*
2.  **On Mac Terminal:** Run `./refresh-tokens.sh`.
    *   *This script SCPs the tokens to the EC2 instance (`~/.notebooklm-mcp-cli/profiles/default/`) and restarts the `notebooklm-mcp` service.*
    *   *Script location:* `.../Notebook LM Claude Integration (Maintenance ORG Folder) /refresh-tokens.sh` [10].

#### **2. Update Command (`jacob-bd`)**
To update the underlying MCP package to the latest version, run the following on the EC2 instance [11]:

```bash
uv tool install --force notebooklm-mcp-cli
sudo systemctl restart notebooklm-mcp
```

#### **3. Service Management**
If you need to restart the service manually (e.g., after a configuration change):
*   **Restart:** `sudo systemctl restart notebooklm-mcp` [11].
*   **Check Status:** `sudo systemctl status notebooklm-mcp --no-pager` [11].

================================================================================
END OF EXTRACTION
================================================================================
